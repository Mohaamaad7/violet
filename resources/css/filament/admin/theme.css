@import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&family=IBM+Plex+Sans+Arabic:wght@400;500;600;700&display=swap');
@import '../../../../vendor/filament/filament/resources/css/theme.css';

@source '../../../../app/Filament/**/*';
@source '../../../../resources/views/filament/**/*';

/* Luxury Violet Theme - Task 9.8 UI Overhaul */

:root {
  --lux-font: 'Cairo', 'IBM Plex Sans Arabic', system-ui, sans-serif;
}

body, .fi-body, .fi-main, .fi-sidebar, .fi-topbar {
  font-family: var(--lux-font);
  font-feature-settings: 'kern' 1, 'liga' 1;
}

/* Sidebar Luxury Style - EXACT FULL HEIGHT MATCH */
.fi-sidebar {
  @apply bg-gradient-to-b from-violet-950 via-violet-900 to-violet-800 shadow-xl;
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  bottom: 0 !important;
  width: 280px !important;
  height: 100vh !important;
  z-index: 50 !important;
  overflow-y: auto;
}

[dir="rtl"] .fi-sidebar {
  right: 0 !important;
  left: auto !important;
}

/* Adjust main content for fixed sidebar */
.fi-main-ctn,
.fi-main {
  margin-left: 280px !important;
  min-height: 100vh !important;
}

[dir="rtl"] .fi-main-ctn,
[dir="rtl"] .fi-main {
  margin-left: 0 !important;
  margin-right: 280px !important;
}

/* Body and layout adjustments */
.fi-body {
  min-height: 100vh !important;
}

.fi-layout {
  min-height: 100vh !important;
}

/* Sidebar Brand/Header Area - inside the purple column */
.fi-sidebar-header,
.fi-sidebar .fi-logo {
  @apply text-white;
}

.fi-sidebar-header {
  @apply px-6 py-6 mb-4 flex items-center justify-center;
  background: linear-gradient(180deg, rgba(23, 6, 56, 0.25) 0%, rgba(23, 6, 56, 0) 100%);
}

.fi-logo { @apply flex items-center justify-center gap-2; }
.fi-logo img { @apply object-contain; max-height: 3.5rem; }
.fi-logo .fi-logo-text { @apply text-white text-xl font-bold; letter-spacing: .5px; }

/* Force White Text for ALL Sidebar Elements (EXCEPT Active) */
.fi-sidebar:not(.fi-sidebar-item-active),
.fi-sidebar *:not(.fi-sidebar-item-active):not(.fi-sidebar-item-active *),
.fi-sidebar a:not(.fi-sidebar-item-active a),
.fi-sidebar button:not(.fi-sidebar-item-active button),
.fi-sidebar .fi-sidebar-item:not(.fi-sidebar-item-active),
.fi-sidebar .fi-sidebar-item-button:not(.fi-sidebar-item-active .fi-sidebar-item-button),
.fi-sidebar .fi-sidebar-item-label:not(.fi-sidebar-item-active .fi-sidebar-item-label),
.fi-sidebar .fi-sidebar-nav-item:not(.fi-sidebar-item-active .fi-sidebar-nav-item),
.fi-sidebar .fi-sidebar-nav-icon:not(.fi-sidebar-item-active .fi-sidebar-nav-icon),
.fi-sidebar svg:not(.fi-sidebar-item-active svg) {
  color: white;
}

.fi-sidebar .fi-sidebar-item-icon:not(.fi-sidebar-item-active .fi-sidebar-item-icon),
.fi-sidebar .fi-icon:not(.fi-sidebar-item-active .fi-icon) {
  color: white;
}

/* Sidebar Navigation Items */
.fi-sidebar nav .fi-sidebar-item,
.fi-sidebar .fi-nav-group {
  @apply rounded-md;
}

/* CRITICAL FIX: Sidebar Active State - Based on Official Filament CSS Structure */
.fi-sidebar .fi-sidebar-item.fi-active > .fi-sidebar-item-btn,
.fi-sidebar .fi-sidebar-item.fi-active .fi-sidebar-item-btn {
  @apply bg-white/95 shadow-md;
  font-weight: 600;
}

/* CRITICAL FIX: Active Item Text Visibility - Official Filament Hook Classes */
.fi-sidebar .fi-sidebar-item.fi-active > .fi-sidebar-item-btn > .fi-sidebar-item-label,
.fi-sidebar .fi-sidebar-item.fi-active > .fi-sidebar-item-btn > .fi-icon,
.fi-sidebar .fi-sidebar-item.fi-active .fi-sidebar-item-label,
.fi-sidebar .fi-sidebar-item.fi-active .fi-sidebar-item-icon,
.fi-sidebar .fi-sidebar-item.fi-active svg,
.fi-sidebar .fi-sidebar-item.fi-active a,
.fi-sidebar .fi-sidebar-item.fi-active button,
.fi-sidebar .fi-sidebar-item.fi-active span {
    color: rgb(51 65 85) !important; /* slate-700 */
    fill: rgb(51 65 85) !important;
}

/* CRITICAL FIX: Sidebar Hover State - Dark Text on Light Background */
.fi-sidebar .fi-sidebar-item:hover,
.fi-sidebar .fi-sidebar-item-button:hover,
.fi-sidebar .fi-sidebar-item:hover a,
.fi-sidebar .fi-sidebar-item:hover .fi-sidebar-item-label,
.fi-sidebar .fi-sidebar-item:hover .fi-sidebar-item-icon,
.fi-sidebar .fi-sidebar-item:hover svg {
  @apply bg-white/80;
  color: rgb(124 58 237) !important; /* violet-600 */
}

/* Navigation Group Labels - Distinct Section Headers */
.fi-sidebar .fi-sidebar-group,
.fi-sidebar .fi-sidebar-group-label,
.fi-sidebar-group-label {
  @apply bg-white/10 rounded-lg px-3 py-2 mt-4 mb-2 text-white font-semibold text-xs uppercase tracking-wider;
  backdrop-filter: blur(8px);
}

.fi-sidebar .fi-sidebar-group-label:first-child {
  @apply mt-2;
}

/* Topbar refinement - RTL mirror: search near sidebar (right), user on far left */
.fi-topbar {
  @apply backdrop-blur bg-white/80 dark:bg-violet-950/80 border-b border-violet-200 dark:border-violet-800 shadow-sm;
  padding: 0.75rem 1rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: .75rem;
}

.fi-topbar .fi-btn, .fi-topbar .fi-icon-btn { @apply rounded-md; }

/* Base order (LTR): search on left, user on right */
.fi-topbar .fi-global-search { order: 1; margin-inline-end: auto; }
.fi-topbar .fi-user-menu, .fi-topbar .fi-avatar { order: 3; margin-inline-start: auto; }

/* RTL mirror: search on the right adjacent to sidebar, user on far left */
[dir="rtl"] .fi-topbar { flex-direction: row-reverse; }
[dir="rtl"] .fi-topbar .fi-global-search { order: 1; margin-inline-end: 0; margin-inline-start: auto; }
[dir="rtl"] .fi-topbar .fi-user-menu, 
[dir="rtl"] .fi-topbar .fi-avatar { order: 3; margin-inline-start: 0; margin-inline-end: auto; }

/* Global Search Enhancements */
.fi-global-search-input {
  @apply bg-white/90 dark:bg-violet-900/50 border-violet-200 dark:border-violet-700 rounded-lg shadow-sm;
  min-width: 300px;
}

.fi-global-search-input:focus {
  @apply ring-2 ring-violet-500 border-violet-500;
}

/* User Avatar Button */
.fi-avatar {
  @apply ring-2 ring-violet-200 dark:ring-violet-700 hover:ring-violet-300 dark:hover:ring-violet-600 transition-all duration-150;
}

/* Remove excessive margins in header area */
.fi-topbar > *,
.fi-topbar .fi-header-actions,
.fi-topbar .fi-topbar-start,
.fi-topbar .fi-topbar-end {
  margin: 0;
  padding-top: 0;
  padding-bottom: 0;
}

/* Language action group buttons */
.fi-topbar .locale-active .fi-btn {
  @apply ring-2 ring-violet-500 dark:ring-violet-400;
}

/* Widget cards elevated */
.fi-widget, .fi-dashboard-widget, .fi-stats-overview, .fi-stats-overview > * {
  @apply shadow-lg rounded-xl bg-white dark:bg-violet-900/40 border border-violet-200/60 dark:border-violet-700/50 backdrop-blur;
}

/* Stats Overview numbers accent */
.fi-stats-overview .fi-stat-value {
  @apply text-violet-600 dark:text-violet-300 font-semibold;
}
.fi-stats-overview .fi-stat-description {
  @apply text-sm text-gray-500 dark:text-violet-200/70;
}

/* Buttons luxury feel */
.fi-btn {
  @apply rounded-md font-medium transition-all duration-150;
}
.fi-btn-primary {
  @apply bg-violet-600 hover:bg-violet-500 text-white shadow-md;
}
.fi-btn-outline-primary {
  @apply border-violet-600 text-violet-600 hover:bg-violet-50;
}

/* Scrollbar subtle styling */
.fi-sidebar ::-webkit-scrollbar { width: 8px; }
.fi-sidebar ::-webkit-scrollbar-track { @apply bg-violet-950; }
.fi-sidebar ::-webkit-scrollbar-thumb { @apply bg-violet-700 rounded-full; }
.fi-sidebar ::-webkit-scrollbar-thumb:hover { @apply bg-violet-600; }

/* Forms & tables subtle elevation */
.fi-form, .fi-table {
  @apply bg-white dark:bg-violet-900/30 rounded-xl shadow-sm border border-violet-100 dark:border-violet-800;
}

/* Refine badges */
.fi-badge-primary {
  @apply bg-violet-600/90 text-white;
}

/* Code fences */
.fi-code-block { @apply bg-violet-950/60 text-violet-100 rounded-lg; }

/* Transition for sidebar collapse */
.fi-sidebar { transition: width .25s ease; }

/* Dark mode adjustments */
.dark .fi-sidebar { @apply from-violet-950 via-violet-900 to-violet-800; }
.dark .fi-topbar { @apply bg-violet-950/85; }
.dark .fi-btn-primary { @apply bg-violet-500 hover:bg-violet-400; }

/* Fallback generic card containers */
[class*='widget'] { @apply shadow-lg; }
