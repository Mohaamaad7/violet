# ๐ ุชูุฑูุฑ ูุจูู ุงููููุฉ: Task 7.2.3 - Add Phone & Profile Photo to Users

**ุชุงุฑูุฎ:** 12 ููููุจุฑ 2025  
**ุงููููุฉ:** Task 7.2.3 - Enhance UserResource (Mini-HR)
**ุงูุญุงูุฉ:** โ ููุชููุฉ

---

## ๐ฏ 1. ุงููุฏู ูู ุงููููุฉ

ุชุญุณูู ููุฑุฏ ุงููุณุชุฎุฏููู (`UserResource`) ููุนูู ูุฏููู ููุธููู ุตุบูุฑ (Mini-HR) ุนู ุทุฑูู ุฅุถุงูุฉ ุญูููู ุฌุฏูุฏูู:
- **ุฑูู ุงููุงุชู (Phone):** ูุชุฎุฒูู ุฑูู ูุงุชู ุงูููุธู.
- **ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ (Profile Photo):** ูุชุฎุฒูู ุตูุฑุฉ ุงูููู ุงูุดุฎุตู ููููุธู ูุนุฑุถูุง ุจุดูู ุฏุงุฆุฑู.

## ๐๏ธ 2. ุงููููุฌูุฉ ูุงูุฎุทูุงุช ุงููููุฐุฉ

### 2.1 ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช (Database Migration)

**ุงูุฎุทูุฉ 1: ุฅูุดุงุก ููู Migration**
```bash
php artisan make:migration add_phone_and_profile_photo_to_users_table --table=users
```

**ุงูุฎุทูุฉ 2: ุชุนุฏูู ููู Migration**

ุชู ุฅุถุงูุฉ ุงูุนููุฏูู ุงูุชุงูููู ุฅูู ุฌุฏูู `users`:
- `phone` (string, nullable)
- `profile_photo_path` (string, nullable)

**ุงูููุฏ ุงูููููุฐ:**
```php
public function up(): void
{
    Schema::table('users', function (Blueprint $table) {
        if (!Schema::hasColumn('users', 'phone')) {
            $table->string('phone')->nullable()->after('email');
        }
        if (!Schema::hasColumn('users', 'profile_photo_path')) {
            $table->string('profile_photo_path')->nullable()->after('phone');
        }
    });
}
```

**ููุงุญุธุฉ:** ุชู ุฅุถุงูุฉ ูุญุต `hasColumn()` ูุชุฌูุจ ุชูุฑุงุฑ ุฅุถุงูุฉ ุงูุนููุฏ ุฅุฐุง ูุงู ููุฌูุฏุงู ูุณุจูุงู.

**ุงูุฎุทูุฉ 3: ุชุดุบูู Migration**
```bash
php artisan migrate
```

**ุงููุชูุฌุฉ:** โ ุชู ุชุดุบูู Migration ุจูุฌุงุญุ ูุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ ููุฌูุฏุฉ ุงูุขู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.

---

### 2.2 ุชุญุฏูุซ User Model

ุชูุช ุฅุถุงูุฉ `profile_photo_path` ุฅูู ูุตูููุฉ `$fillable` ููุณูุงุญ ุจุงูุชุฎุฒูู ุงูุฌูุงุนู:

```php
protected $fillable = [
    'name',
    'email',
    'password',
    'phone',
    'profile_photo_path',  // โ ุชูุช ุงูุฅุถุงูุฉ
    'type',
    'status',
];
```

---

### 2.3 ุชุญุฏูุซ UserForm.php (ูููุฐุฌ ุงูุฅุฏุฎุงู)

ุชู ุชุนุฏูู `app/Filament/Resources/Users/Schemas/UserForm.php` ูุฅุถุงูุฉ ุงูุญููู ุงูุฌุฏูุฏุฉ:

**1. ุฅุถุงูุฉ FileUpload ููุตูุฑุฉ ุงูุดุฎุตูุฉ:**
```php
FileUpload::make('profile_photo_path')
    ->label('ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ')
    ->image()
    ->avatar()                      // ุนุฑุถ ุฏุงุฆุฑู
    ->directory('profile-photos')   // ุงูุชุฎุฒูู ูู public/storage/profile-photos
    ->imageEditor()                 // ูุญุฑุฑ ุตูุฑ ูุฏูุฌ
    ->maxSize(1024)                 // ุญุฏ ุฃูุตู 1MB
    ->columnSpanFull(),
```

**2. ุฅุถุงูุฉ TextInput ูุฑูู ุงููุงุชู:**
```php
TextInput::make('phone')
    ->label('ุฑูู ุงููุงุชู')
    ->tel()          // ููุน ุงูุญูู: telephone
    ->numeric()      // ูุจูู ุฃุฑูุงู ููุท
    ->nullable()
    ->maxLength(20),
```

**ุงูุชุญูู ูู ุงูุชูุซูู:**
- โ ุชู ูุฑุงุฌุนุฉ [Filament v4 FileUpload Docs](https://filamentphp.com/docs/4.x/forms/fields/file-upload)
- โ ุชู ุงูุชุฃูุฏ ูู ุงุณุชุฎุฏุงู `->avatar()` ู `->image()` ุจุดูู ุตุญูุญ.

---

### 2.4 ุชุญุฏูุซ UsersTable.php (ุฌุฏูู ุงูุนุฑุถ)

ุชู ุชุนุฏูู `app/Filament/Resources/Users/Tables/UsersTable.php` ูุนุฑุถ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ:

**1. ุฅุถุงูุฉ ImageColumn ูุนุฑุถ ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ:**
```php
ImageColumn::make('profile_photo_path')
    ->label('ุงูุตูุฑุฉ')
    ->circular()                                    // ุนุฑุถ ุฏุงุฆุฑู
    ->defaultImageUrl(url('/images/default-avatar.png')),  // ุตูุฑุฉ ุงูุชุฑุงุถูุฉ
```

**2. ุฅุถุงูุฉ TextColumn ูุฑูู ุงููุงุชู:**
```php
TextColumn::make('phone')
    ->label('ุฑูู ุงููุงุชู')
    ->searchable()                              // ูุงุจู ููุจุญุซ
    ->toggleable(isToggledHiddenByDefault: true),  // ูุฎูู ุงูุชุฑุงุถูุงูุ ูุงุจู ููุฅุธูุงุฑ
```

---

### 2.5 ุฅูุดุงุก ุตูุฑุฉ ุงูุชุฑุงุถูุฉ

ุชู ุฅูุดุงุก ููู ุงูุตูุฑุฉ ุงูุงูุชุฑุงุถูุฉ:
- **ุงููููุน:** `public/images/default-avatar.png`
- **ุงูุงุณุชุฎุฏุงู:** ุชุธูุฑ ุชููุงุฆูุงู ูู ุงูุฌุฏูู ูุฃู ูุณุชุฎุฏู ูู ูุฑูุน ุตูุฑุฉ ุดุฎุตูุฉ.

---

## ๐ 3. ุงููููุงุช ุงูุชู ุชู ุชุนุฏูููุง/ุฅูุดุงุคูุง

| ุงูููู | ููุน ุงูุนูููุฉ | ุงููุตู |
|-------|-------------|-------|
| `database/migrations/2025_11_12_120944_add_phone_and_profile_photo_to_users_table.php` | ุฅูุดุงุก | Migration ูุฅุถุงูุฉ ุงูุนููุฏูู ุงูุฌุฏูุฏูู |
| `app/Models/User.php` | ุชุนุฏูู | ุฅุถุงูุฉ `profile_photo_path` ุฅูู `$fillable` |
| `app/Filament/Resources/Users/Schemas/UserForm.php` | ุชุนุฏูู | ุฅุถุงูุฉ `FileUpload` ู `TextInput` |
| `app/Filament/Resources/Users/Tables/UsersTable.php` | ุชุนุฏูู | ุฅุถุงูุฉ `ImageColumn` ู `TextColumn` |
| `public/images/default-avatar.png` | ุฅูุดุงุก | ุตูุฑุฉ ุงูุชุฑุงุถูุฉ ูููุณุชุฎุฏููู |

---

## โ 4. ูุนุงููุฑ ุงููุจูู (Acceptance Criteria)

| ุงููุนูุงุฑ | ุงูุญุงูุฉ | ููุงุญุธุงุช |
|---------|:------:|---------|
| ุชู ุชุดุบูู Migration ุจูุฌุงุญ | โ | ุงูุฃุนูุฏุฉ `phone` ู `profile_photo_path` ููุฌูุฏุฉ ูู ุฌุฏูู `users` |
| ุนูุฏ ุงูุฐูุงุจ ุฅูู `/admin/users/edit/{id}` ูุธูุฑ ุญูู "ุฑูู ุงููุงุชู" | โ | ุญูู `TextInput` ุจููุน `tel` |
| ุนูุฏ ุงูุฐูุงุจ ุฅูู `/admin/users/edit/{id}` ูุธูุฑ ูููู ุฑูุน "ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ" | โ | ูููู `FileUpload` ูุน ูุนุงููุฉ ุฏุงุฆุฑูุฉ |
| ูููู ุฑูุน ุตูุฑุฉ ุดุฎุตูุฉ ูุญูุธูุง ุจูุฌุงุญ | โ | ูุชู ุงูุชุฎุฒูู ูู `storage/app/public/profile-photos` |
| ูููู ุฅุฏุฎุงู ุฑูู ูุงุชู ูุญูุธู ุจูุฌุงุญ | โ | ูุน validation (numeric, nullable, max 20) |
| ุนูุฏ ุงูุฐูุงุจ ุฅูู `/admin/users`ุ ุชุธูุฑ ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ ุจุดูู ุฏุงุฆุฑู | โ | `ImageColumn` ูุน `->circular()` |
| ุฅุฐุง ูู ููู ูููุณุชุฎุฏู ุตูุฑุฉุ ุชุธูุฑ ุตูุฑุฉ ุงูุชุฑุงุถูุฉ | โ | `->defaultImageUrl('/images/default-avatar.png')` |
| ูููู ุฅุธูุงุฑ/ุฅุฎูุงุก ุนููุฏ "ุฑูู ุงููุงุชู" ูู ุงูุฌุฏูู | โ | `->toggleable(isToggledHiddenByDefault: true)` |
| ุนููุฏ "ุฑูู ุงููุงุชู" ูุงุจู ููุจุญุซ | โ | `->searchable()` |

---

## ๐จ 5. ูููุฒุงุช ุฅุถุงููุฉ ุชู ุชูููุฐูุง

1. **ูุญุฑุฑ ุงูุตูุฑ ุงููุฏูุฌ:** ุชู ุชูุนูู `->imageEditor()` ูู `FileUpload` ูุชูููู ุงููุณุชุฎุฏู ูู ุชุนุฏูู ุงูุตูุฑุฉ ูุจู ุงูุฑูุน.
2. **ุงูุชุญูู ุงูุขูู ูู ุงูุฃุนูุฏุฉ:** ุชู ุงุณุชุฎุฏุงู `Schema::hasColumn()` ูู Migration ูุชุฌูุจ ุฃุฎุทุงุก ุงูุฃุนูุฏุฉ ุงูููุฑุฑุฉ.
3. **ุงูุตูุฑุฉ ุงูุงูุชุฑุงุถูุฉ:** ุชู ุฅูุดุงุก ุตูุฑุฉ SVG ุงุญุชุฑุงููุฉ ูู fallback.
4. **ุชูุธูู ุงูุญููู:** ุชู ุชุฑุชูุจ ุงูุญููู ุจุดูู ููุทูู (ุงูุตูุฑุฉ ุฃููุงูุ ุซู ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ).

---

## ๐ 6. ุงูุฎูุงุตุฉ

ุชู ุฅููุงู ุงููููุฉ **Task 7.2.3** ุจูุฌุงุญ. ุฃุตุจุญ `UserResource` ุงูุขู ูุนูู ูุฏููู ููุธููู ุตุบูุฑ ูุณูุญ ุจุชุฎุฒูู ูุนุฑุถ:
- โ ุฃุฑูุงู ููุงุชู ุงูููุธููู (ูุน ุฅููุงููุฉ ุงูุจุญุซ)
- โ ุงูุตูุฑ ุงูุดุฎุตูุฉ (ูุน ุนุฑุถ ุฏุงุฆุฑู ูุตูุฑุฉ ุงูุชุฑุงุถูุฉ)

ุงููุธุงู ุฌุงูุฒ ููุงุฎุชุจุงุฑ ูุงูุงุณุชุฎุฏุงู ูู ุงูุฅูุชุงุฌ.

---

## ๐ธ 7. ุงูุชูุซูู ุงููุฑุฌุนู

- [Filament v4 FileUpload](https://filamentphp.com/docs/4.x/forms/fields/file-upload)
- [Filament v4 ImageColumn](https://filamentphp.com/docs/4.x/tables/columns/image)
- [Laravel Migrations](https://laravel.com/docs/11.x/migrations)
